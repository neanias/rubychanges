---
title: Ruby 3.3 changes
prev: /
next: 3.2
description: Ruby 3.3 full and annotated changelog
---

# Ruby 3.3

* **Released at:** Dec 25, 2023 ([NEWS.md](TODO) file)
* **Status (as of <<date>>):** TODO
* **This document first published:** TODO
* **Last change to this document:** <<date>>

<!--
* **Reason:**
* **Discussion:**
* **Documentation:**
* **Code:**
* **Notes:**
-->

### `Array#pack` and `String#unpack`: raise `ArgumentError` for unknown directives

* **Reason:**
* **Discussion:** [Bug #19150]
* **Documentation:** [doc/packed_data.rdoc](https://docs.ruby-lang.org/en/master/packed_data_rdoc.html)
* **Code:**
* **Notes:**

### `Dir.for_fd` and `Dir.fchdir`

* **Reason:**
* **Discussion:** [Feature #19347]
* **Documentation:** [Dir.for_fd](https://docs.ruby-lang.org/en/master/Dir.html#method-c-for_fd), [Dir.fchdir](https://docs.ruby-lang.org/en/master/Dir.html#method-c-fchdir)
* **Code:**
* **Notes:**

### `Dir#chdir`

* **Reason:**
* **Discussion:** [Feature #19347]
* **Documentation:** [Dir#chdir](https://docs.ruby-lang.org/en/master/Dir.html#method-i-chdir)
* **Code:**
* **Notes:**

### `MatchData#named_captures`: `symbolize_names:` argument

* **Reason:**
* **Discussion:** [Feature #19591]
* **Documentation:** [MatchData#named_captures](https://docs.ruby-lang.org/en/master/MatchData.html#method-i-named_captures)
* **Code:**
* **Notes:**

### `Module#set_temporary_name`

Allows to assign a string to be rendered as class/module's `#name`, without assigning the class/module to a constant.

* **Reason:** The feature is useful to provide reasonable representation for dynamically auto-generated classes without assigning them to constants (which pollutes the global namespace and might conflict with existing constants) or redefining `Class#name` (which might break other code and not always respected in the output).
* **Discussion:** [Feature #19521]
* **Documentation:** [Module#set_temporary_name](https://docs.ruby-lang.org/en/master/Module.html#method-i-set_temporary_name)
* **Code:**
* **Notes:**

### `ObjectSpace::WeakKeyMap`

A new "weak map" concept implementation. Unlike `ObjectSpace::WeakMap`, it compares keys by equality (`WeakMap` compares by identity), and only references to keys are weak (garbage-collectible).

* **Reason:** The idea of a new class grew out of increased usage of `ObjectSpace::WeakMap` (which was once considered internal). In many other languages, concept of "weak map" implies only key references are weak: this allows to use it as a generic "holder of some additional information related to a set of objects while they are alive," or just a weak set of objects (using them as keys and `true` as values): caches, deduplication sets, etc.
* **Discussion:** [Feature #18498]
* **Documentation:** [ObjectSpace::WeakKeyMap](https://docs.ruby-lang.org/en/master/ObjectSpace/WeakKeyMap.html)
* **Code:**
* **Notes:** The class interface is significantly leaner than `WeakMap`'s, and doesn't provide any kind of iteration methods (which is very hard to implement and use correctly with weakly-referenced objects), so the new class is more like a black box with associations than a collection.

### `ObjectSpace::WeakMap#delete`

* **Reason:** `WeakMap` is frequently used to have a loose list of objects that will need some processing at some point of program execution if they are still alive/used (that's why `WeekMap` and not `Array`/`Hash` is chosen in those cases). But it is possible that the code author wants to process objects conditionally, and to remove those which don't need processing anymore—even if they are still alive. `WeekMap` quacks like kind-of simple `Hash`, yet previously provided no way to delete keys.
* **Discussion:** [Feature #19561]
* **Documentation:** [ObjectSpace::WeakMap#delete](https://docs.ruby-lang.org/en/master/ObjectSpace/WeakMap.html#method-i-delete)
* **Code:**
  ```ruby
  files_to_close = ObjectSpace::WeakMap.new
  file1 = File.new('README.md')
  file2 = File.new('NEWS.md')

  files_to_close[file1] = true
  files_to_close[file2] = true

  files_to_close.delete(file1) #=> true

  # Attempt to delete non-existing key:
  files_to_close.delete(file1) #=> nil
  # An optional block can be provided in case the key doesn't exist:
  files_to_close.delete(file1) { puts "Already removed"; 0 }
  # Prints "Already removed", returns `0`

  # The block wouldn't be called if the deletion was effectful:
  files_to_close.delete(file2) { puts "Already removed"; 0 }
  # Prints nothing, returns true
  ```
* **Notes:**

### `Proc#dup` and `#clone` call `#initialize_dup` and `#initialize_clone`

* **Reason:**
* **Discussion:** [Feature #19362]
* **Documentation:** — (Adheres to the behavior described for [Object#dup](https://docs.ruby-lang.org/en/master/Object.html#method-i-dup) and [#clone](https://docs.ruby-lang.org/en/master/Kernel.html#method-i-clone))
* **Code:**
* **Notes:**

### `Process.warmup`

* **Reason:**
* **Discussion:** [Feature #18885]
* **Documentation:** [Process.warmup](https://docs.ruby-lang.org/en/master/Process.html#method-c-warmup)
* **Code:**
* **Notes:**

### `Process::Status#&`  and `#>>` are deprecated

* **Reason:**
* **Discussion:** [Bug #19868]
* **Documentation:** [Process::Status#&](https://docs.ruby-lang.org/en/master/Process/Status.html#method-i-26), [#>>](https://docs.ruby-lang.org/en/master/Process/Status.html#method-i-3E-3E)
* **Code:**
* **Notes:**

### `Thread::Queue#freeze` and `SizedQueue#freeze` raise `TypeError`

* **Reason:**
* **Discussion:** [Bug #17146]
* **Documentation:** [Thread::Queue#freeze](https://docs.ruby-lang.org/en/master/Thread/Queue.html#method-i-freeze) and [Thread::SizedQueue#freeze](https://docs.ruby-lang.org/en/master/Thread/SizedQueue.html#method-i-freeze)
* **Code:**
* **Notes:**

### `Range#reverse_each` behavior change with semi-open ranges

* **Reason:**
* **Discussion:** [Feature #18515], [Feature #18551]
* **Documentation:** [Range#reverse_each](https://docs.ruby-lang.org/en/master/Range.html#method-i-reverse_each)
* **Code:**
* **Notes:**

### `Refinement#target` as an alternative of `Refinement#refined_class`

* **Reason:**
* **Discussion:** [Feature #19714]
* **Documentation:** [Refinement#target](https://docs.ruby-lang.org/en/master/Refinement.html#method-i-target)
* **Code:**
* **Notes:**

### `String#bytesplice`: new arguments to select a portion of the replacement string

* **Reason:**
* **Discussion:** [Feature #19314]
* **Documentation:** [String#bytesplice](https://docs.ruby-lang.org/en/master/String.html#method-i-bytesplice)
* **Code:**
* **Notes:**

### `TracePoint` supports `rescue` event

* **Reason:**
* **Discussion:** [Feature #19572]
* **Documentation:** [TracePoint#Events](https://docs.ruby-lang.org/en/master/TracePoint.html#class-TracePoint-label-Events)
* **Code:**
* **Notes:**

### `Kernel#lambda` behavior change with non-lambda blocks

* **Reason:**
* **Discussion:** [Feature #19777]
* **Documentation:**
* **Code:**
* **Notes:**

### Deprecate subprocess creation with method dedicated to files

* **Reason:**
* **Discussion:** [Feature #19630]
* **Documentation:**
* **Affected methods:**
  * Kernel#open
  * URI.open
  * IO.binread
  * IO.foreach
  * IO.readlines
  * IO.read
  * IO.write
* **Code:**
* **Notes:**

### New `Warning` category: `:performance`

* **Reason:**
* **Discussion:** [Feature #19538]
* **Documentation:** [Warning#[category]](https://docs.ruby-lang.org/en/master/Warning.html#method-c-5B-5D)
* **Code:**
* **Notes:**
